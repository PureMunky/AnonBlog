!function(){function t(t){t.when("/",{templateUrl:"partials/frontpage.html",controllerAs:"vm",bindToController:!0,controller:"MainCtrl"}).when("/write",{template:"<div ab-write></div>"}).when("/helpout",{templateUrl:"partials/helpout.html"}).when("/:id",{templateUrl:"partials/view.html"}).otherwise({redirectTo:"/"})}angular.module("app",["ngRoute"]).config(t),t.$inject=["$routeProvider"]}(),function(){function t(){}angular.module("app").controller("MainCtrl",t)}(),function(){function t(t){var e=this;e.form={comments:[]}}angular.module("app").controller("View",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t,e){function r(e){t.messages.push(e)}function n(){e.sendMessage(t.post._id,t.form.message),t.form.message=""}t.messages=[],t.form={message:""},t.sendMessage=n,e.onMessage(t.post._id,r)}var e={restrict:"A",templateUrl:"partials/directives/chat.html",scope:{post:"="},controller:t};return t.$inject=["$scope","Chat"],e}angular.module("app").directive("abChat",t)}(),function(){"use strict";function t(){function t(t,e){t.form={display:!1,body:""},t.comment=function(){t.form.display=!0},t.save=function(){e.Write({Body:t.form.body,Parent:t.parent})}}var e={restrict:"A",templateUrl:"partials/directives/comment.html",scope:{parent:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abComment",t)}(),function(){"use strict";function t(){function t(t){function e(t){n.messages.push(t)}function r(){n.messages.splice(0,1)}var n=this;n.messages=["Server Error: Error getting post data.","Server Error: Error getting promotion data."],t.addReporter(e),n.dismissMessage=r}var e={restrict:"A",scope:{},templateUrl:"partials/directives/errorDisplay.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["errorMessageSvc"],e}angular.module("app").directive("abErrorDisplay",t)}(),function(){"use strict";function t(){function t(t,e){function r(){return t.GetAll()}function n(t){return t}function o(t){return t.length>300&&(t=t.substring(0,300)+"..."),e.parse(t)}var i=this;i.posts=[],i.parseBody=o,r().then(function(t){var e=0;for(e=0;e<t.length;e++)i.posts.push(n(t[e]))})}var e={restrict:"A",scope:{},templateUrl:"partials/directives/front.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","textBodyService"],e}angular.module("app").directive("abFront",t)}(),function(){"use strict";function t(){function t(t,e){}var e={restrict:"A",templateUrl:"partials/directives/postComments.html",scope:{comments:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abPostComments",t)}(),function(){"use strict";function t(){function t(t,e){function r(){t.GetPromoteTime(l.post._id).then(o)}function n(){t.Promote(l.post._id).then(o)["catch"](function(t){console.log(t)})}function o(t){t&&(l.data=t,l.totalTime=l.data.totalTime,u(Math.round(l.data.remainingTime/1e3)))}function i(){m--,0>=m&&l.promoted?(l.promoted=!1,r()):0>=m?l.promoted=!1:l.promoted=!0,l.promotePercentage=s(),p&&!c()&&$timeout.cancel(p),c()||e.addTicker(i,1e3)}function a(){var t="Promote me!";if(!c())switch(!0){case m>60:var e=Math.round(m/60);t=e+(1===e?" Minute":" Minutes");break;default:t="<1 Minute"}return t}function s(){var t="0%";return l.data&&(t=Math.round(100*((l.data.promotedTime-m)/(l.data.totalTime-m)))+"%"),t}function c(){return 0>=m}function u(t){m=t,i()}var l=this;l.promoted=!1,l.totalTime=-1,l.promotePercentage="0%",l.promote=n,l.getRemaining=a;var p,m;r()}var e={restrict:"A",templateUrl:"partials/directives/promote.html",scope:{post:"="},controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","globalTimerSvc"],e}angular.module("app").directive("abPromote",t)}(),function(){"use strict";function t(){function t(t,e,r,n,o){function i(){return o.parse(s.post.Body)}function a(){t.Get(r.id).then(function(t){console.log(t),s.post=t})}var s=this;s.form={comments:[]},s.PostBody=i,s.post={Title:"hello",Body:"something"},a()}var e={restrict:"A",scope:{post:"="},templateUrl:"partials/directives/view.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","$scope","$routeParams","$sce","textBodyService"],e}angular.module("app").directive("abPostView",t)}(),function(){"use strict";function t(){function t(t,e){var r=this;r.post={Title:"",Body:""},r.write=function(){e.Write(r.post).then(function(e){t.path("/")})}}var e={restrict:"A",scope:{},templateUrl:"partials/directives/write.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["$location","Posts"],e}angular.module("app").directive("abWrite",t)}(),function(){"use strict";function t(t){function e(t,e){s[t]||(s[t]=[]),s[t].push(e),o(t)}function r(t,e){var r=0;if(s[t])for(r=0;r<s[t].length;r++)s[t][r](e)}function n(e,r){t.Write({Body:r,Parent:e})}function o(e){c[e]=[],setInterval(function(){t.GetComments(e).then(function(t){return i(e,t.data)}).then(function(t){var n=0;for(n=0;n<t.length;n++)!function(n){r(e,t[n])}(n)})},5e3)}function i(t,e){var r=0,n=0,o=!1,i=[];for(r=0;r<e.length;r++){for(o=!1,n=0;n<c[t].length;n++)c[t][n]._id===e[r]._id&&(o=!0);o||(i.push(e[r]),c[t].push(e[r]))}return i}var a={onMessage:e,sendMessage:n},s=[],c=[];return a}angular.module("app").service("Chat",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t){var e=0;for(e=0;e<o.length;e++)o[e](t)}function e(e){t(e)}function r(t){o.push(t)}var n={},o=[];return n.sendMessage=e,n.addReporter=r,n}angular.module("app").service("errorMessageSvc",t),t.$inject=[]}(),function(){"use strict";function t(t){function e(t,e){i.push({func:t,interval:e,sinceLast:0}),n()}function r(){var t,e,r=0;for(r=0;r<i.length;r++)t=i[r].interval-i[r].sinceLast,(e>t||void 0===e)&&(e=t);return e}function n(){var e=0;for(e=0;e<i.length;e++)i[e].sinceLast>i[e].interval&&(i[e].sinceLast=0,i.func());t(n,r())}var o={},i=[];return o.addTicker=e,o}angular.module("app").service("globalTimerSvc",t),t.$inject=["$timeout"]}(),function(){"use strict";function t(t,e,r){function n(){return t.get("/post").then(u)}function o(r){var n=e.defer();return m[r]?n.resolve(m[r]):t.get("/post/"+r).then(u).then(function(t){n.resolve(t)}),n.promise}function i(e){return t.get("/post/"+e+"/comments").then(u)}function a(e){return t.post("/post",e).then(u)}function s(e){return t.post("/post/"+e+"/promote").then(l)}function c(e){return t.get("/post/"+e+"/promote").then(l)}function u(t){var e=0,n=t.data;if(n.success)if(n.data instanceof Array)for(e=0;e<n.data.length;e++)m[n.data[e]._id]=n.data[e];else n.data._id&&(m[n.data._id]=n.data);else r.sendMessage(n.message+": Error getting post data.");return n.data}function l(t){var e=t.data;return e.success||r.sendMessage(e.message||": Error getting promotion data."),e.data}var p={Promote:s,GetAll:n,Get:o,GetComments:i,Write:a,GetPromoteTime:c},m={};return p}angular.module("app").service("Posts",t),t.$inject=["$http","$q","errorMessageSvc"]}(),function(){function t(t){function e(e){var r=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e=e.replace("\n","<br/>"),e=e?e.replace(r,"<a href='$1' target='_blank'>$1</a>"):"",t.trustAsHtml(e)}var r={parse:e};return r}angular.module("app").service("textBodyService",t),t.$inject=["$sce"]}();