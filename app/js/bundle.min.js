!function(){function t(t){t.when("/",{templateUrl:"partials/frontpage.html",controllerAs:"vm",bindToController:!0,controller:"MainCtrl"}).when("/write",{template:"<div ab-write></div>"}).when("/helpout",{templateUrl:"partials/helpout.html"}).when("/:id",{templateUrl:"partials/view.html"}).otherwise({redirectTo:"/"})}angular.module("app",["ngRoute"]).config(t),t.$inject=["$routeProvider"]}(),function(){"use strict";function t(){function t(t,e){function n(e){t.messages.push(e)}function o(){e.sendMessage(t.post._id,t.form.message),t.form.message=""}t.messages=[],t.form={message:""},t.sendMessage=o,e.onMessage(t.post._id,n)}var e={restrict:"A",templateUrl:"partials/directives/chat.html",scope:{post:"="},controller:t};return t.$inject=["$scope","Chat"],e}angular.module("app").directive("abChat",t)}(),function(){"use strict";function t(t){function e(t,e){c[t]||(c[t]=[]),c[t].push(e),r(t)}function n(t,e){var n=0;if(c[t])for(n=0;n<c[t].length;n++)c[t][n](e)}function o(e,n){t.Write({Body:n,Parent:e})}function r(e){a[e]=[],setInterval(function(){t.GetComments(e).then(function(t){return i(e,t.data)}).then(function(t){var o=0;for(o=0;o<t.length;o++)!function(o){n(e,t[o])}(o)})},5e3)}function i(t,e){var n=0,o=0,r=!1,i=[];for(n=0;n<e.length;n++){for(r=!1,o=0;o<a[t].length;o++)a[t][o]._id===e[n]._id&&(r=!0);r||(i.push(e[n]),a[t].push(e[n]))}return i}var s={onMessage:e,sendMessage:o},c=[],a=[];return s}angular.module("app").service("Chat",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t,e){t.form={display:!1,body:""},t.comment=function(){t.form.display=!0},t.save=function(){e.Write({Body:t.form.body,Parent:t.parent})}}var e={restrict:"A",templateUrl:"partials/directives/comment.html",scope:{parent:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abComment",t)}(),function(){"use strict";function t(){function t(t,e){function n(){t.GetAll().then(function(t){r.posts=t.data})}function o(t){return e.parse(t)}var r=this;r.parseBody=o,n()}var e={restrict:"A",scope:{},templateUrl:"partials/directives/front.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","textBodyService"],e}angular.module("app").directive("abFront",t)}(),function(){function t(){}angular.module("app").controller("MainCtrl",t)}(),function(){"use strict";function t(){function t(t,e){}var e={restrict:"A",templateUrl:"partials/directives/postComments.html",scope:{comments:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abPostComments",t)}(),function(){"use strict";function t(t){function e(){return t.get("/post")}function n(e){return t.get("/post/"+e)}function o(e){return t.get("/post/"+e+"/comments")}function r(e){return t.post("/post",e)}function i(e){return t.post("/post/"+e+"/promote")}function s(e){return t.get("/post/"+e+"/promote")}var c={Promote:i,GetAll:e,Get:n,GetComments:o,Write:r,GetPromoteTime:s};return c}angular.module("app").service("Posts",t),t.$inject=["$http"]}(),function(){"use strict";function t(){function t(t,e){function n(){e.GetPromoteTime(a.post._id).then(function(t){t&&c(Math.round(t.data.remainingTime/1e3))})}function o(){e.Promote(a.post._id).then(function(t){n()})["catch"](function(t){console.log(t)})}function r(){l--,0>=l&&a.promoted?(a.promoted=!1,n()):0>=l?a.promoted=!1:a.promoted=!0,u&&!s()&&t.cancel(u),s()||(u=t(r,1e3))}function i(){var t="Promote me!";if(!s())switch(!0){case l>60:var e=Math.round(l/60);t=e+(1===e?" Minute":" Minutes");break;default:t="<1 Minute"}return t}function s(){return 0>=l}function c(t){l=t,r()}var a=this;a.promoted=!1,a.promote=o,a.getRemaining=i;var u,l;n()}var e={restrict:"A",templateUrl:"partials/directives/promote.html",scope:{post:"="},controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["$timeout","Posts"],e}angular.module("app").directive("abPromote",t)}(),function(){function t(t){function e(e){var n=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e=e.replace("\n","<br/>"),e=e?e.replace(n,"<a href='$1' target='_blank'>$1</a>"):"",t.trustAsHtml(e)}var n={parse:e};return n}angular.module("app").service("textBodyService",t),t.$inject=["$sce"]}(),function(){function t(t){var e=this;e.form={comments:[]}}angular.module("app").controller("View",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t,e,n,o,r){function i(){return r.parse(c.post.Body)}function s(){t.Get(n.id).then(function(t){console.log(t),c.post=t.data}),t.GetComments(n.id).then(function(t){c.form.comments=t.data})}var c=this;c.form={comments:[]},c.PostBody=i,s()}var e={restrict:"A",scope:{post:"="},templateUrl:"partials/directives/view.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","$scope","$routeParams","$sce","textBodyService"],e}angular.module("app").directive("abPostView",t)}(),function(){"use strict";function t(){function t(t){var e=this;e.post={Title:"",Body:""},e.write=function(){t.Write(e.post).then(function(t){})}}var e={restrict:"A",scope:{},templateUrl:"partials/directives/write.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts"],e}angular.module("app").directive("abWrite",t)}();