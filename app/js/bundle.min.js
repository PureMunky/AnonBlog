!function(){function t(t){t.when("/",{templateUrl:"partials/frontpage.html",controllerAs:"vm",bindToController:!0,controller:"MainCtrl"}).when("/write",{template:"<div ab-write></div>"}).when("/helpout",{templateUrl:"partials/helpout.html"}).when("/:id",{templateUrl:"partials/view.html"}).otherwise({redirectTo:"/"})}angular.module("app",["ngRoute"]).config(t),t.$inject=["$routeProvider"]}(),function(){"use strict";function t(){function t(t,e){function n(e){t.messages.push(e)}function o(){e.sendMessage(t.post._id,t.form.message),t.form.message=""}t.messages=[],t.form={message:""},t.sendMessage=o,e.onMessage(t.post._id,n)}var e={restrict:"A",templateUrl:"partials/directives/chat.html",scope:{post:"="},controller:t};return t.$inject=["$scope","Chat"],e}angular.module("app").directive("abChat",t)}(),function(){"use strict";function t(t){function e(t,e){a[t]||(a[t]=[]),a[t].push(e),r(t)}function n(t,e){var n=0;if(a[t])for(n=0;n<a[t].length;n++)a[t][n](e)}function o(e,n){t.Write({Body:n,Parent:e})}function r(e){c[e]=[],setInterval(function(){t.GetComments(e).then(function(t){return i(e,t.data)}).then(function(t){var o=0;for(o=0;o<t.length;o++)!function(o){n(e,t[o])}(o)})},5e3)}function i(t,e){var n=0,o=0,r=!1,i=[];for(n=0;n<e.length;n++){for(r=!1,o=0;o<c[t].length;o++)c[t][o]._id===e[n]._id&&(r=!0);r||(i.push(e[n]),c[t].push(e[n]))}return i}var s={onMessage:e,sendMessage:o},a=[],c=[];return s}angular.module("app").service("Chat",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t,e){t.form={display:!1,body:""},t.comment=function(){t.form.display=!0},t.save=function(){e.Write({Body:t.form.body,Parent:t.parent})}}var e={restrict:"A",templateUrl:"partials/directives/comment.html",scope:{parent:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abComment",t)}(),function(){"use strict";function t(){function t(t,e){function n(){t.GetAll().then(function(t){r.posts=t})}function o(t){return e.parse(t)}var r=this;r.parseBody=o,n()}var e={restrict:"A",scope:{},templateUrl:"partials/directives/front.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","textBodyService"],e}angular.module("app").directive("abFront",t)}(),function(){function t(){}angular.module("app").controller("MainCtrl",t)}(),function(){"use strict";function t(){function t(t,e){}var e={restrict:"A",templateUrl:"partials/directives/postComments.html",scope:{comments:"="},controller:t};return t.$inject=["$scope","Posts"],e}angular.module("app").directive("abPostComments",t)}(),function(){"use strict";function t(t,e){function n(){return t.get("/post").then(c)}function o(n){var o=e.defer();return p[n]?o.resolve(p[n]):t.get("/post/"+n).then(c).then(function(t){o.resolve(t)}),o.promise}function r(e){return t.get("/post/"+e+"/comments").then(c)}function i(e){return t.post("/post",e).then(c)}function s(e){return t.post("/post/"+e+"/promote").then(u)}function a(e){return t.get("/post/"+e+"/promote").then(u)}function c(t){var e=0;if(t.data instanceof Array)for(e=0;e<t.data.length;e++)p[t.data[e]._id]=t.data[e];else t.data._id&&(p[t.data._id]=t.data);return t.data}function u(t){return t.data}var l={Promote:s,GetAll:n,Get:o,GetComments:r,Write:i,GetPromoteTime:a},p={};return l}angular.module("app").service("Posts",t),t.$inject=["$http","$q"]}(),function(){"use strict";function t(){function t(t,e){function n(){e.GetPromoteTime(u.post._id).then(r)}function o(){e.Promote(u.post._id).then(r)["catch"](function(t){console.log(t)})}function r(t){t&&c(Math.round(t.remainingTime/1e3))}function i(){p--,0>=p&&u.promoted?(u.promoted=!1,n()):0>=p?u.promoted=!1:u.promoted=!0,l&&!a()&&t.cancel(l),a()||(l=t(i,1e3))}function s(){var t="Promote me!";if(!a())switch(!0){case p>60:var e=Math.round(p/60);t=e+(1===e?" Minute":" Minutes");break;default:t="<1 Minute"}return t}function a(){return 0>=p}function c(t){p=t,i()}var u=this;u.promoted=!1,u.promote=o,u.getRemaining=s;var l,p;n()}var e={restrict:"A",templateUrl:"partials/directives/promote.html",scope:{post:"="},controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["$timeout","Posts"],e}angular.module("app").directive("abPromote",t)}(),function(){function t(t){function e(e){var n=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e=e.replace("\n","<br/>"),e=e?e.replace(n,"<a href='$1' target='_blank'>$1</a>"):"",t.trustAsHtml(e)}var n={parse:e};return n}angular.module("app").service("textBodyService",t),t.$inject=["$sce"]}(),function(){function t(t){var e=this;e.form={comments:[]}}angular.module("app").controller("View",t),t.$inject=["Posts"]}(),function(){"use strict";function t(){function t(t,e,n,o,r){function i(){return r.parse(a.post.Body)}function s(){t.Get(n.id).then(function(t){console.log(t),a.post=t})}var a=this;a.form={comments:[]},a.PostBody=i,a.post={Title:"hello",Body:"something"},s()}var e={restrict:"A",scope:{post:"="},templateUrl:"partials/directives/view.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["Posts","$scope","$routeParams","$sce","textBodyService"],e}angular.module("app").directive("abPostView",t)}(),function(){"use strict";function t(){function t(t,e){var n=this;n.post={Title:"",Body:""},n.write=function(){e.Write(n.post).then(function(e){t.path("/")})}}var e={restrict:"A",scope:{},templateUrl:"partials/directives/write.html",controllerAs:"vm",bindToController:!0,controller:t};return t.$inject=["$location","Posts"],e}angular.module("app").directive("abWrite",t)}();